

mapboxgl.accessToken = mapboxToken;
var map = new mapboxgl.Map({
    container: 'map',
    // style: 'mapbox://styles/mapbox/streets-v11',
    style: "mapbox://styles/xirli/cm1xl4op7014d01qr717j9s9n",
    center: [30.4, 50.4],
    zoom: 10
});

fetch('/get_markers')
    .then(response => response.json())
    .then(markersData => {
        markersData.forEach(createMarker);
    })
    .catch(error => console.error('Error loading tags:', error));

const icons = {
"Community Mourning":`<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" fill="#EEF296" version="1.1" id="Capa_1" width="800px" height="800px" viewBox="0 0 506.961 506.961" xml:space="preserve">
<g>
	<path d="M140.858,259.578v-75.321c0,0,18.788,21.5,37.894,0c19.109-21.5,107.871,5.122,107.871,5.122v229.376H140.858v-92.857   c-9.847,4.131-9.516-4.569-5.198-17.136c-0.375,0.49-0.583,0.757-0.583,0.757C108.609,326.174,127.875,284.456,140.858,259.578z    M183.208,150.932c1.108,1.38,2.778,2.178,4.545,2.178h11.573c-0.975,0-1.835-0.556-2.252-1.427   c-7.628-16.21-8.946-30.384-3.91-42.129c6.735-15.729,22.34-21.092,22.999-21.308c1.028-0.346,2.172,0.018,2.808,0.907   c0.624,0.884,0.612,2.08-0.059,2.94c-7.063,9.241-0.946,15.841-0.168,16.621c20.522,21.692,3.611,43.246,3.437,43.456   c-0.479,0.582-1.188,0.928-1.938,0.928h16.816c2.264,0,4.321-1.306,5.284-3.354c17.969-38.192,21.075-71.582,9.224-99.244   c-15.87-37.066-52.635-49.68-54.184-50.2c-2.438-0.81-5.113,0.062-6.597,2.143c-1.501,2.083-1.442,4.903,0.109,6.936   c16.639,21.784,2.231,37.321,0.399,39.156C142.944,99.659,182.804,150.423,183.208,150.932z M418.528,455.023   c-9.233,7.069-20.221,11.124-30.134,11.124c-8.547,0-15.723-3.05-20.693-8.411c-5.391,1.603-11.13,2.56-16.479,3.115   c-0.586,4.321-1.33,9.209-1.33,14.387c0,17.525-14.198,31.724-31.718,31.724H106.703c-17.517,0-31.723-14.198-31.723-31.724   c0-17.514-8.449-31.723,9.067-31.723h51.867v-13.093h153.068v13.093h42.428l0.012-0.207c5.456,0.325,19.157,0.201,29.672-2.577   c-0.035-11.852,7.034-25.133,19.802-34.897c9.078-6.957,19.729-14.062,29.825-14.062c6.603,0,12.33,2.914,16.544,8.417   C438.004,414.245,436.538,441.25,418.528,455.023z M412.865,411.218c-0.992-1.3-1.549-1.3-2.146-1.3   c-3.528,0-9.859,3.469-18.808,10.326c-10.982,8.398-15.072,20.066-11.396,24.884c1.939,2.524,5.77,2.896,7.885,2.896   c6.012,0,12.98-2.695,19.128-7.395C418.25,432.42,417.062,416.704,412.865,411.218z"/>
</g>
</svg>`,
"Public Engagement Issues":`<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" height="800px" width="800px" version="1.1" id="Layer_1" viewBox="0 0 496.159 496.159" xml:space="preserve">
<path style="fill:#E04F5F;" d="M496.159,248.086c0-137.022-111.07-248.082-248.076-248.082C111.071,0.004,0,111.063,0,248.086  c0,137.001,111.07,248.07,248.083,248.07C385.089,496.155,496.159,385.086,496.159,248.086z"/>
<g>
	<path style="fill:#FFFFFF;" d="M259.432,128.917c-3.409-1.851-7.559-1.688-10.813,0.425l-95.137,61.791h-35.164   c-5.845,0-10.583,4.738-10.583,10.582v92.728c0,5.845,4.738,10.583,10.583,10.583h35.164l95.137,61.79   c1.748,1.135,3.754,1.708,5.765,1.708c1.733,0,3.471-0.426,5.049-1.283c3.41-1.852,5.534-5.42,5.534-9.301V138.219   C264.966,134.339,262.842,130.768,259.432,128.917z"/>
	<path style="fill:#FFFFFF;" d="M355.405,248.079l30.384-30.384c3.515-3.516,3.515-9.213,0-12.729   c-3.515-3.514-9.213-3.514-12.728,0l-30.384,30.385l-30.384-30.385c-3.515-3.514-9.213-3.514-12.728,0   c-3.515,3.516-3.515,9.213,0,12.729l30.385,30.384l-30.384,30.384c-3.515,3.516-3.515,9.213,0,12.729   c1.757,1.757,4.061,2.636,6.364,2.636c2.303,0,4.606-0.879,6.364-2.636l30.384-30.385l30.384,30.385   c1.757,1.757,4.061,2.636,6.364,2.636c2.303,0,4.606-0.879,6.364-2.636c3.515-3.516,3.515-9.213,0-12.729L355.405,248.079z"/>
</g>
</svg>`,
"Community Engagement": `<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" fill="#508D69" version="1.1" id="Capa_1" width="800px" height="800px" viewBox="0 0 45.22 45.22" xml:space="preserve">
<g>
	<g>
		<circle cx="22.611" cy="5.024" r="3.552"/>
		<path d="M26.436,12.675c-0.399-2-2.289-3.373-4.339-3.099c-1.696,0.225-2.99,1.51-3.309,3.099c1.07-0.792,2.394-1.262,3.824-1.262    S25.364,11.884,26.436,12.675z"/>
		<path d="M35.291,29.401c-0.814-0.717-2.057-0.637-2.772,0.178l-2.8,3.18c-0.717,0.814-0.637,2.057,0.178,2.773    c0.373,0.328,0.836,0.49,1.297,0.49c0.545,0,1.087-0.227,1.476-0.668l2.798-3.181C36.186,31.36,36.106,30.118,35.291,29.401z"/>
		<path d="M32.669,10.911c-0.718-0.814-1.959-0.894-2.772-0.177c-0.814,0.717-0.895,1.959-0.178,2.773l2.8,3.181    c0.389,0.441,0.931,0.667,1.477,0.667c0.461,0,0.923-0.161,1.297-0.489c0.814-0.717,0.895-1.959,0.177-2.773L32.669,10.911z"/>
		<g>
			<path d="M22.629,23.517c-0.006,0-0.031,0-0.037,0c-1.251,0-2.444,0.567-3.278,1.502c-0.834,0.934-1.231,2.194-1.09,3.438     l2.019,13.048c0.138,1.229,1.144,2.244,2.368,2.244c1.226,0,2.229-1.007,2.37-2.238l2.017-13.056     c0.142-1.243-0.256-2.504-1.09-3.438C25.072,24.085,23.881,23.517,22.629,23.517z"/>
			<circle cx="22.61" cy="18.078" r="4.33"/>
		</g>
		<g>
			<path d="M41.219,17.509c-0.005,0-0.027,0-0.033,0c-1.14,0-2.226,0.517-2.984,1.367c-0.76,0.85-1.121,1.998-0.993,3.131     l1.837,11.878c0.126,1.12,1.042,2.043,2.156,2.043c1.115,0,2.03-0.917,2.157-2.036l1.836-11.887     c0.128-1.132-0.233-2.279-0.992-3.129S42.358,17.509,41.219,17.509z"/>
			<circle cx="41.202" cy="12.557" r="3.942"/>
		</g>
	</g>
	<g>
		<path d="M9.93,29.401c0.815-0.717,2.057-0.637,2.773,0.178l2.799,3.18c0.717,0.814,0.637,2.057-0.177,2.773    c-0.373,0.328-0.836,0.49-1.297,0.49c-0.545,0-1.087-0.227-1.476-0.668l-2.798-3.181C9.036,31.36,9.114,30.118,9.93,29.401z"/>
		<path d="M12.55,10.911c0.718-0.814,1.959-0.894,2.773-0.177c0.814,0.717,0.894,1.959,0.177,2.773l-2.799,3.181    c-0.389,0.441-0.931,0.667-1.477,0.667c-0.461,0-0.923-0.161-1.297-0.489c-0.814-0.717-0.894-1.959-0.177-2.773L12.55,10.911z"/>
		<g>
			<path d="M4.001,17.509c0.005,0,0.028,0,0.034,0c1.139,0,2.225,0.517,2.984,1.367c0.76,0.85,1.121,1.998,0.993,3.131L6.174,33.885     c-0.126,1.12-1.042,2.043-2.156,2.043c-1.115,0-2.03-0.917-2.157-2.036L0.025,22.005c-0.128-1.132,0.233-2.279,0.992-3.129     C1.776,18.026,2.861,17.509,4.001,17.509z"/>
			<circle cx="4.019" cy="12.557" r="3.942"/>
		</g>
	</g>
</g>
</svg>`,
"Quality of Services": `<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" width="256" height="256" viewBox="0 0 256 256" xml:space="preserve">

<defs>
</defs>
<g style="stroke: none; stroke-width: 0; stroke-dasharray: none; stroke-linecap: butt; stroke-linejoin: miter; stroke-miterlimit: 10; fill: none; fill-rule: nonzero; opacity: 1;" transform="translate(1.4065934065934016 1.4065934065934016) scale(2.81 2.81)">
	<circle cx="45" cy="45" r="45" style="stroke: none; stroke-width: 1; stroke-dasharray: none; stroke-linecap: butt; stroke-linejoin: miter; stroke-miterlimit: 10; fill: rgb(255,92,92); fill-rule: nonzero; opacity: 1;" transform="  matrix(1 0 0 1 0 0) "/>
	<path d="M 20.1 27.7 h 10.2 c 0.8 0 1.4 0.6 1.4 1.4 v 27.2 c 0 0.8 -0.6 1.4 -1.4 1.4 H 20.1 V 27.7 z" style="stroke: none; stroke-width: 1; stroke-dasharray: none; stroke-linecap: butt; stroke-linejoin: miter; stroke-miterlimit: 10; fill: rgb(255,255,255); fill-rule: nonzero; opacity: 1;" transform=" matrix(1 0 0 1 0 0) " stroke-linecap="round"/>
	<path d="M 66.1 50.3 c 2.1 0 3.8 1.7 3.8 3.8 s -1.7 3.8 -3.8 3.8 H 54.2 c 2.1 3.7 2.1 15.1 -2.8 16.5 c -0.9 0.3 -1.9 -0.5 -2 -1.4 c -0.9 -8 -5.7 -17.9 -10.7 -18.2 h -3.9 V 30.9 h 2 c 1.1 0 2.1 -0.4 3 -1 c 2.2 -1.5 6 -2.4 9.6 -2.3 h 1.8 v 0 h 12 c 2.1 0 3.8 1.7 3.8 3.8 s -1.7 3.8 -3.8 3.8 H 65 c 2.1 0 3.8 1.7 3.8 3.8 s -1.7 3.8 -3.8 3.8 h 1.1 c 2.1 0 3.8 1.7 3.8 3.8 S 68.2 50.3 66.1 50.3 z" style="stroke: none; stroke-width: 1; stroke-dasharray: none; stroke-linecap: butt; stroke-linejoin: miter; stroke-miterlimit: 10; fill: rgb(255,255,255); fill-rule: nonzero; opacity: 1;" transform=" matrix(1 0 0 1 0 0) " stroke-linecap="round"/>
</g>
</svg>`,
"Corruption in Privatization": `<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" fill="#000000" height="800px" width="800px" version="1.1" id="Layer_1" viewBox="0 0 512.001 512.001" xml:space="preserve">
<g>
	<g>
		<path d="M219.33,183.844l-68.403-8.024l-44.733-44.448l42.431,22.245l16.754,1.966V136.13c0-16.843-13.654-30.498-30.498-30.498    H80.494c-16.843,0-30.498,13.654-30.498,30.498l-0.537,349.656C49.418,500.222,61.088,511.959,75.526,512c0.026,0,0.05,0,0.076,0    c14.402,0,26.097-11.654,26.138-26.066l0.547-193.255c0-0.024-0.001-0.049-0.001-0.073h10.162l0.014,193.257    c0.001,14.436,11.706,26.139,26.142,26.138c14.436-0.001,26.139-11.706,26.138-26.142l-0.008-104.198    c-11.64-4.281-19.965-15.479-19.965-28.585c0-7.82,0-68.253,0-75.809c0-13.346,8.636-24.705,20.611-28.803v-5.15l-29.542-3.465    c-8.695-1.02-19.377-0.814-25.632-12.366l-34.719-65.206l50.073,49.753c3.46,3.437,7.973,5.614,12.816,6.182l75.879,8.901    c11.972,1.401,22.773-7.169,24.172-19.097C239.828,196.067,231.278,185.245,219.33,183.844z"/>
	</g>
</g>
<g>
	<g>
		<path d="M234.49,318.039v9.266c2.352-0.553,4.217-1.867,4.217-4.356C238.708,320.666,236.98,319.214,234.49,318.039z"/>
	</g>
</g>
<g>
	<g>
		<path d="M226.192,300.889c0,2.006,1.798,3.251,4.425,4.356v-8.229C227.506,297.639,226.192,299.229,226.192,300.889z"/>
	</g>
</g>
<g>
	<g>
		<path d="M295.473,265.719H272.64c0-13.797,0-16.193,0-32.273c0-6.138-4.975-11.113-11.113-11.113h-4.562    c-4.103,9.793-11.626,17.633-20.93,22.227h14.378v21.16H220.27v-16.808c-5.472,0.432-7.862-0.079-22.227-1.764v18.571H175.21    c-6.379,0-11.549,5.171-11.549,11.549v75.809c0,6.379,5.171,11.549,11.549,11.549h120.262c6.379,0,11.549-5.171,11.549-11.549    v-75.809C307.022,270.89,301.851,265.719,295.473,265.719z M235.182,336.917v2.006c0,0.968-1.314,1.867-2.628,1.867    c-1.521,0-2.627-0.899-2.627-1.867v-1.729c-8.298-0.277-15.075-4.564-15.075-8.99c0-2.352,2.075-5.809,4.702-5.809    c2.905,0,5.255,4.08,10.373,4.979v-11.202c-6.362-2.42-13.83-5.394-13.83-14.245c0-1.873,0.31-3.526,0.847-4.998    c1.978-5.428,7.217-8.225,12.984-9.041v-1.936c0-0.968,1.107-1.867,2.627-1.867c1.315,0,2.628,0.899,2.628,1.867v1.729    c4.287,0.139,12.378,1.245,12.378,6.017c0,0.856-0.266,2.116-0.841,3.232c-0.681,1.32-1.798,2.438-3.446,2.438    c-2.099,0-3.386-1.869-7.077-2.438c-0.321-0.049-0.653-0.092-1.013-0.12v0.12v9.976c6.293,2.352,13.623,5.602,13.623,14.937    C248.804,330.416,243.272,335.603,235.182,336.917z"/>
	</g>
</g>
<g>
	<g>
		<path d="M462.065,317.034c-7.922,15.852-25.458,25.458-43.881,22.5c-2.908-0.467-5.697-1.229-8.343-2.243l0.42,148.643    C410.303,500.346,421.997,512,436.4,512c0.024,0,0.051,0,0.076,0c14.437-0.041,26.107-11.778,26.066-26.214L462.065,317.034z"/>
	</g>
</g>
<g>
	<g>
		<circle cx="106.81" cy="45.146" r="45.146"/>
	</g>
</g>
<g>
	<g>
		<circle cx="372.294" cy="45.146" r="45.146"/>
	</g>
</g>
<g>
	<g>
		<path d="M462.006,161.042c0-30.601-24.807-55.408-55.408-55.408h-29.477c-16.843,0-30.498,13.654-30.498,30.498v7.146    l-34.932,36.751l-52.279,16.435c0.481,2.274,0.786,4.603,0.895,6.976c18.64,0,30.5,13.665,31.189,28.605l38.635-12.146    c3.525-1.108,6.71-3.095,9.256-5.773l7.236-7.613c0,0-0.457,44.725-0.475,279.343c-0.001,14.437,11.701,26.141,26.138,26.142    c0.001,0,0.001,0,0.001,0c14.436,0,26.139-11.702,26.141-26.138l0.011-155.197c-11.288-9.235-17.187-23.93-14.788-38.876    l12.602-78.472l-5.187-58.95l23.937,67.591l-11.721,72.984c-1.907,11.88,6.176,23.057,18.055,24.964    c11.85,1.907,23.05-6.153,24.961-18.053l12.602-78.472c0.579-3.601,0.243-7.288-0.974-10.725l-25.792-72.828l29.87,44.396V161.042    z"/>
	</g>
</g>
</svg>`,
"Missing Pets": `<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" fill="#EEF296" height="800px" width="800px" version="1.1" id="Layer_1" viewBox="0 0 512 512" xml:space="preserve">
<g>
	<g>
		<g>
			<path d="M115.652,306.304c4.181,2.074,9.284,0.401,11.401-3.789c2.125-4.181,0.444-9.31-3.729-11.46     c-1.237-0.64-30.455-16.171-38.11-62.063c-0.623-3.772-3.686-6.664-7.501-7.074c-3.9-0.435-7.415,1.766-8.841,5.308     c-18.517,46.31,16.401,99.533,17.894,101.777c1.638,2.466,4.352,3.797,7.1,3.797c1.621,0,3.268-0.469,4.727-1.434     c3.917-2.611,4.983-7.902,2.381-11.827c-0.213-0.324-14.66-22.417-19.115-48.435C95.898,296.132,114.551,305.749,115.652,306.304     z"/>
			<path d="M155.273,324.096c4.617-0.922,7.62-5.419,6.699-10.035c-0.93-4.617-5.376-7.62-10.044-6.69     c-17.126,3.422-49.528,22.067-49.528,68.096c0,33.399,6.997,56.568,12.399,69.453c-18.68,3.627-29.466,15.377-29.466,32.947     C85.333,497.647,103.279,512,128,512h8.533c14.148,0,22.852-10.607,23.791-11.81c2.901-3.712,2.244-9.079-1.476-11.981     c-3.712-2.91-9.079-2.236-11.972,1.468c-0.043,0.06-4.378,5.257-10.342,5.257H128c-12.723,0-25.6-5.862-25.6-17.067     c0-4.224,0-17.067,25.6-17.067c3.132,0,5.999-1.732,7.492-4.489c1.493-2.756,1.34-6.118-0.367-8.738     c-0.162-0.247-15.659-24.559-15.659-72.107C119.467,332.194,153.856,324.403,155.273,324.096z"/>
			<path d="M397.201,444.919c5.402-12.885,12.399-36.053,12.399-69.453c0-46.029-32.401-64.674-49.527-68.096     c-4.625-0.913-9.114,2.065-10.044,6.69c-0.922,4.617,2.082,9.114,6.699,10.035c1.468,0.299,35.806,7.672,35.806,51.371     c0,47.548-15.497,71.859-15.633,72.064c-1.741,2.62-1.911,5.99-0.427,8.764c1.485,2.773,4.378,4.506,7.526,4.506     c25.6,0,25.6,12.843,25.6,17.067c0,11.204-12.877,17.067-25.6,17.067h-8.533c-5.888,0-10.223-5.111-10.394-5.316     c-2.91-3.644-8.226-4.292-11.921-1.408c-3.721,2.901-4.378,8.269-1.476,11.981c0.939,1.203,9.643,11.81,23.791,11.81H384     c24.73,0,42.667-14.353,42.667-34.133C426.667,460.297,415.881,448.546,397.201,444.919z"/>
			<path d="M308.634,444.382l15.514-93.107c0.776-4.651-2.364-9.045-7.014-9.822c-4.668-0.768-9.045,2.364-9.813,7.006     l-15.881,95.275h-1.306c-4.719,0-8.533,3.823-8.533,8.533c0,4.71,3.814,8.533,8.533,8.533h8.533c25.6,0,25.6,12.843,25.6,17.067     c0,11.204-12.877,17.067-25.6,17.067h-8.533c-14.114,0-25.6-11.486-25.6-25.6V349.867c0-4.71-3.814-8.533-8.533-8.533     c-4.719,0-8.533,3.823-8.533,8.533v119.467c0,14.114-11.486,25.6-25.6,25.6h-8.533c-12.723,0-25.6-5.862-25.6-17.067     c0-4.224,0-17.067,25.6-17.067h8.533c4.719,0,8.533-3.823,8.533-8.533c0-4.71-3.814-8.533-8.533-8.533h-1.306l-15.88-95.275     c-0.759-4.642-5.154-7.774-9.813-7.006c-4.651,0.777-7.791,5.171-7.014,9.822l15.514,93.107     c-20.668,2.859-32.7,14.925-32.7,33.485c0,19.78,17.946,34.133,42.667,34.133h8.533c13.943,0,26.342-6.724,34.133-17.092     C263.791,505.276,276.19,512,290.133,512h8.533c24.73,0,42.667-14.353,42.667-34.133     C341.333,459.307,329.301,447.241,308.634,444.382z"/>
			<path d="M468.429,72.986C449.673,35.465,404.489,0,375.467,0c-16.478,0-44.834,25.549-59.076,39.475     C299.93,25.37,279.893,17.067,256,17.067s-43.93,8.303-60.39,22.409C181.367,25.549,153.011,0,136.533,0     c-29.022,0-74.206,35.465-92.962,72.986c-5.649,11.281-9.438,26.53-9.438,37.948c0,23.526,19.14,42.667,42.667,42.667     c21.205,0,30.694-13.943,38.306-25.148c0.93-1.357,1.852-2.722,2.927-4.25l34.133-51.2c2.62-3.925,1.562-9.225-2.364-11.836     c-3.942-2.628-9.225-1.562-11.836,2.364l-34.005,51.012c-1.007,1.425-1.988,2.867-2.97,4.309     c-7.672,11.298-12.587,17.681-24.192,17.681c-14.114,0-25.6-11.486-25.6-25.6c0-8.866,3.14-21.333,7.637-30.319     c16.811-33.63,57.455-63.548,77.696-63.548c7.279,0,28.945,16.947,47.01,34.509c-32.06,37.274-47.01,99.678-47.01,161.758     c0,78.788,34.611,110.933,119.467,110.933s119.467-32.145,119.467-110.933c0-62.089-14.95-124.484-47.01-161.758     c18.065-17.562,39.723-34.509,47.01-34.509c20.241,0,60.885,29.918,77.705,63.548c4.489,8.986,7.629,21.453,7.629,30.319     c0,14.114-11.486,25.6-25.6,25.6c-12.023,0-16.768-6.315-24.772-18.406l-36.395-54.596c-2.611-3.925-7.91-4.992-11.836-2.364     c-3.925,2.611-4.983,7.91-2.364,11.836l36.361,54.545c8.09,12.211,17.246,26.052,39.006,26.052     c23.526,0,42.667-19.14,42.667-42.667C477.867,99.516,474.078,84.267,468.429,72.986z M358.4,213.333     c0,69.308-26.803,93.867-102.4,93.867s-102.4-24.559-102.4-93.867c0-89.199,31.667-179.2,102.4-179.2     S358.4,124.134,358.4,213.333z"/>
			<path d="M299.614,252.092c-1.459,2.842-7.159,3.874-9.481,3.908c-9.992,0-20.318-8.508-24.047-18.287     c14.029-3.174,24.047-12.689,24.047-24.38c0-14.353-14.993-25.6-34.133-25.6s-34.133,11.247-34.133,25.6     c0,11.691,10.018,21.205,24.047,24.38C242.193,247.492,231.868,256,221.926,256c-2.449-0.034-8.03-1.067-9.591-4.002     c-2.21-4.164-7.373-5.743-11.537-3.533s-5.751,7.373-3.533,11.537c6.741,12.698,22.793,13.065,24.602,13.065     c13.252,0,26.069-7.569,34.133-18.398c8.064,10.829,20.881,18.398,34.133,18.398c1.826,0,18.057-0.375,24.653-13.158     c2.159-4.19,0.512-9.335-3.678-11.494S301.781,247.893,299.614,252.092z M256,221.867c-10.257,0-17.067-5.137-17.067-8.533     c0-3.396,6.81-8.533,17.067-8.533c10.419,0,17.067,5.052,17.067,8.533C273.067,216.815,266.419,221.867,256,221.867z"/>
			<path d="M294.4,153.6c7.057,0,12.8-5.743,12.8-12.8s-5.743-12.8-12.8-12.8c-7.057,0-12.8,5.743-12.8,12.8     S287.343,153.6,294.4,153.6z"/>
			<path d="M217.6,153.6c7.057,0,12.8-5.743,12.8-12.8s-5.743-12.8-12.8-12.8s-12.8,5.743-12.8,12.8S210.543,153.6,217.6,153.6z"/>
		</g>
	</g>
</g>
</svg>`,

"Cultural Heritage Concerns": `<svg xmlns="http://www.w3.org/2000/svg" version="1.0" width="1280.000000pt" height="1134.000000pt" viewBox="0 0 1280.000000 1134.000000" preserveAspectRatio="xMidYMid meet">
<metadata>
Created by potrace 1.15, written by Peter Selinger 2001-2017
</metadata>
<g transform="translate(0.000000,1134.000000) scale(0.100000,-0.100000)" fill="#FF8F8F" stroke="none">
<path d="M6285 11325 c-159 -35 -306 -124 -455 -276 l-95 -97 -1110 -1903 c-610 -1047 -1373 -2356 -1695 -2909 -322 -553 -1114 -1911 -1759 -3018 l-1174 -2013 6 -177 c8 -253 32 -369 108 -528 83 -174 206 -278 430 -365 l102 -40 4141 11 c2278 7 4875 15 5771 18 l1630 7 111 56 c150 76 225 128 314 218 164 166 206 323 180 666 l-12 160 -715 1245 c-394 685 -1260 2192 -1926 3350 -665 1158 -1615 2809 -2109 3670 -495 861 -914 1580 -931 1599 -54 57 -193 165 -275 213 -190 112 -370 150 -537 113z m837 -2722 c638 -1094 1290 -2212 3680 -6306 369 -632 669 -1149 667 -1151 -5 -3 -10093 16 -10097 19 -4 3 5022 8665 5028 8665 3 0 328 -552 722 -1227z"/>
<path d="M5470 7159 c-93 -15 -211 -80 -293 -162 -106 -106 -166 -237 -167 -364 0 -66 27 -180 67 -282 33 -84 42 -97 87 -131 186 -138 385 -186 540 -131 32 11 65 26 72 31 14 13 16 10 44 -59 l20 -53 -27 -21 c-103 -79 -216 -207 -287 -325 l-38 -64 6 -91 c22 -281 78 -620 133 -801 30 -100 36 -78 -55 -213 -66 -96 -161 -291 -195 -398 -39 -123 -66 -261 -73 -382 l-7 -110 -231 -143 c-127 -79 -241 -150 -253 -157 -21 -14 -21 -13 -21 33 1 45 -1 49 -63 105 -76 70 -121 94 -231 122 l-83 22 -6 47 c-4 25 -19 66 -33 90 -40 69 -157 198 -191 213 -52 21 -110 27 -154 15 -39 -10 -46 -8 -118 27 -73 36 -81 38 -172 37 -61 0 -116 -6 -151 -17 l-55 -17 -671 -1222 c-370 -673 -671 -1224 -669 -1226 1 -1 701 1 1555 5 l1553 6 -7 111 c-30 497 -175 1001 -396 1375 -17 30 -30 54 -28 56 2 1 100 59 218 128 l215 126 185 -8 c102 -4 188 -6 192 -4 4 2 30 74 59 161 l52 158 240 127 c132 70 241 126 243 124 1 -1 -30 -79 -71 -172 l-73 -170 -11 -410 c-7 -225 -16 -558 -21 -740 -6 -181 -10 -387 -10 -457 l0 -127 -57 -11 c-173 -34 -329 -95 -402 -156 -31 -26 -52 -58 -65 -102 l-7 -22 532 2 533 3 162 735 c89 404 160 738 158 742 -3 5 -20 8 -38 8 -18 0 -35 2 -37 4 -3 3 -1 53 4 112 l8 107 70 76 c126 138 256 337 422 644 l74 138 6 -123 c12 -239 69 -426 227 -737 l79 -156 168 -174 c261 -271 497 -484 863 -781 190 -153 185 -143 125 -265 -35 -73 -75 -123 -209 -269 -43 -48 -77 -88 -75 -89 2 -2 96 -1 209 2 l205 6 92 70 93 70 210 367 c115 202 210 372 210 376 0 4 -53 21 -119 37 l-118 30 -442 500 c-243 275 -445 501 -450 503 -5 2 -16 -15 -25 -38 -9 -22 -20 -40 -25 -40 -18 0 -120 121 -145 172 -54 112 -86 289 -92 510 -6 253 -50 421 -185 698 l-80 165 48 42 c26 23 51 42 56 43 4 0 12 -11 17 -25 18 -46 49 -50 122 -17 105 47 172 116 214 220 l22 56 -23 47 c-29 56 -87 107 -132 115 -18 3 -33 8 -33 11 0 3 -13 84 -30 181 -82 486 -244 872 -429 1019 -31 24 -130 81 -221 125 l-165 81 -140 -17 c-546 -67 -798 -152 -1046 -353 -65 -52 -109 -67 -125 -42 -4 6 -7 77 -8 158 -1 124 -5 155 -24 210 -28 77 -80 161 -136 219 -104 108 -314 176 -466 151z m2075 -933 c158 -74 269 -318 400 -873 l27 -113 -54 -49 c-29 -27 -54 -48 -54 -48 -7 8 -638 1005 -641 1014 -5 14 81 60 147 79 69 19 120 16 175 -10z m-1382 -1107 c62 -32 230 -206 340 -354 53 -71 97 -134 97 -141 0 -6 -27 -76 -59 -155 l-59 -144 -363 -228 c-200 -125 -372 -232 -382 -238 -17 -9 -18 -7 -11 27 21 115 110 260 258 426 53 59 101 119 106 134 34 89 53 486 31 642 -4 28 -6 52 -4 52 2 0 23 -10 46 -21z"/>
</g>
</svg>`

};

function createMarker(markerData) {
    console.log(markerData)

    var el = document.createElement('div');
    el.className = 'marker';

    // Using Font Awesome or any SVG icon
    const keys = Object.keys(icons);
    const randomKey = keys[Math.floor(Math.random() * keys.length)];
    el.innerHTML = icons[randomKey];

    el.style.width = '40px';
    el.style.height = '40px';

    new mapboxgl.Marker(el)
        .setLngLat(markerData.coordinates)
        .addTo(map)
        .getElement()
        .addEventListener('click', function () {
            openFeedProblems(markerData.id);
        });
}




// function openFeedProblems(markerId) {
//     console.log(markerId)
//     fetch(`/get_feed_problems/${markerId}`)
//         .then(response => response.text())
//         .then(feedProblemsHtml => {
//             document.getElementById('feed').innerHTML = feedProblemsHtml;
//             document.getElementById('feed').style.display = 'block';
//             addProblemClickHandlers(markerId);
//         });
// }


function openFeedProblems(markerId) {
    // markerId is expected to be an array of [lat, lng]
    const [lat, lng] = markerId.replace(/[\[\]]/g, '').split(',').map(Number);

    // Construct the URL using lat and lng
        fetch(`/get_feed_problems/${lng},${lat}`)
        .then(response => response.text())
        .then(feedProblemsHtml => {
            // Update the feed content and display it
            document.getElementById('feed').innerHTML = feedProblemsHtml;
            document.getElementById('feed').style.display = 'block';

            // Add click handlers for problems
            addProblemClickHandlers(markerId);
        })
        .catch(error => console.error('Error fetching feed problems:', error));
}



function addProblemClickHandlers(markerId) {
    const problemItems = document.querySelectorAll('.problem-item');


    problemItems.forEach(function (problemItem) {
        const viewProblemLink = problemItem.querySelector('.view-problem');

        viewProblemLink.addEventListener('click', function (event) {
            event.preventDefault();

            const problemId = problemItem.dataset.problemId;
            console.log(problemId)
            openFeedPosts(markerId, problemId);
        });
    });
}


// markersData.forEach(createMarker);

function openFeedPosts(markerId, problemId) {
    fetch(`/get_feed/${markerId}?problemId=${problemId}`)
        .then(response => response.text())
        .then(feedHtml => {
            document.getElementById('feed').innerHTML = feedHtml;
            document.getElementById('feed').style.display = 'block';
            addPostClickHandlers();
        });
}

function addPostClickHandlers() {
    const postItems = document.querySelectorAll('.post-item');

    postItems.forEach(function (postItem) {
        const moveToLocationLink = postItem.querySelector('.move-to-location');

        moveToLocationLink.addEventListener('click', function (event) {
            event.preventDefault();

            const lat = parseFloat(postItem.dataset.lat);
            const lng = parseFloat(postItem.dataset.lng);
            console.log(lat, lng);

            map.flyTo({
                center: [lng, lat],
                zoom: 16
            });
        });
    });
}
